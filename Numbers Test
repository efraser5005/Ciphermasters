import java.util.Random;
import java.util.Scanner;
import java.util.Timer;

public class TestWhatever{
   public static void main(String[] args){
   
   String[] names = {"Esther", "Emma"};
   
   Numbers(1, names);
   
   }
   
   public static int[] Numbers(int level, String[] names){
      System.out.println("This is where the numbers game will be played.");
      
      int[] gameScores = new int[names.length];
      
      int numSmall = 0, numLarge = 0;
      int[] larges = {25, 50, 75, 100};
      
      Random rnd = new Random();
      Scanner sc = new Scanner(System.in);
      
      //Sets number of small numbers by level
      if(level == 1){
         numSmall = 2;
      }
      else if(level == 2){
         numSmall = 3;
      }
      else if(level == 3){
         numSmall = 4;
      }
      else{
         System.out.println("Esther, you've screwed it up! The level is set to something other than 1, 2 or 3. How did that happen?");
      }
      
      int[] numbers = new int[6];
      
      System.out.print("The numbers are: ");
      
      //adds random ints less than 10 to the array "numbers" 
      for(int i = 0; i < numSmall; i++){
         numbers[i] = rnd.nextInt(9) + 1;
         System.out.print(numbers[i] + " ");
      }
      
      for(int i = numSmall; i < 6; i++){
         numbers[i] = larges[rnd.nextInt(4)];
         System.out.print(numbers[i] + " ");
      }
      
      //randomly generates operations to link the numbers and create target number
      int[] operations = new int[5];
      int target = 0;
      
      for(int i = 0; i < 5; i++){
         operations[i] = rnd.nextInt(4) + 1;
         if(operations[i] == 1){
            target += numbers[i];
            //System.out.println("The number is: " + numbers[i] + ". The operation is: + . The target is now: " + target);
         }
         else if(operations[i] == 2){
            if(target > numbers[i]){ //This ensures target stays positive
               target -= numbers[i];
               //System.out.println("The number is: " + numbers[i] + ". The operation is: - . The target is now: " + target);
            }
            else{
               target += numbers[i];
               //System.out.println("The number is: " + numbers[i] + ". The operation is: +. The target is now: " + target);
            }
         }
         else if(operations[i] == 3){
            if(level > 1){
               target = target * numbers[i];
               //System.out.println("The number is: " + numbers[i] + ". The operation is: * . The target is now: " + target);
            }
            else{
               target += numbers[i];
            }
         }
      }
      
      System.out.println("The target number is: " + target);
      
      System.out.println("Time's up!"); //This is in place of the timer method for now
      
      String[] answers = new String[names.length];
      
      //Collects the answers
      for(int i = 0; i < names.length; i++){
         System.out.print(names[i] + ", how did you crack the code? Please enter the arithmetical expression you used: ");
         answers[i] = sc.nextLine();
      }
      
      //Parses and evaluates the answers
      char[] ansOps = new char[5];
      int[] ansNums = new int[6];
      
      
      for(int i = 0; i < answers.length; i++){
         for(int charPos = answers[i].length; charPos > 0; charPos--){
            
            //The first three cases handle the operators, adding them to an array called ansOps         
            if(answers[i].charAt(charPos) == '+'){
               ansOps[5-i] = '+';
            }
            else if(answers[i].charAt(charPos) == '-'){
               ansOps[5-i] = '-';
            }
            else if(answers[i].charAt(charPos) == '*'){
               ansOps[5-i] = '*';
            }
            //This case handles the numbers
            else if(Character.isDigit(answers[i].charAt(charPos))){
               int ansHunds = 0, ansTens = 0, ansUnits = 0;
               //These two nested "if"s handle the cases where the number is 2 or 3 digits long
               if(charPos > 1 && Character.isDigit(answers[i].charAt(charPos-1))){
                  if(charPos > 2 && Character.isDigit(answers[i].charAt(charPos-2))){
                     ansUnits = Character.getNumericValue(answers[i].charAt(charPos));
                  }
                  ansTens = Character.getNumericValue(answers[i].charAt(charPos));
                  ansUnits = Character.getNumericValue(answers[i].charAt(charPos+1));
               }
               ansNums[i] = ansHunds * 100 + ansTens * 10 + Character.getNumericValue(answers[i].charAt(charPos));
               System.out.println("ansNums[i] = " + ansNums[i]);
            }
            //This handles the case where something other than a number of valid operator has been entered. It prompts the user to re-enter their answer. 
            else{
               System.out.print("Error: " + names[i] + " " + answers[i].charAt(charPos) + " is an invalid character. Remember not to put any spaces! Try entering it again: ");
               answers[i] = sc.nextLine();
            }
         }
            
         int ansCheck = ansNums[0];
         
         for(int j = 0; j < 5; j++){
            if(ansOps[j] == 1){
               ansCheck += ansNums[j+1];
            }
            else if(ansOps[j] == 2){
               ansCheck -= ansNums[j+1];
            }
            else if(ansOps[j] == 3){
               ansCheck = ansCheck * ansNums[j+1];
            }
            System.out.println(ansCheck);
         }
         
         //checks is ansCheck is the same as target number and scores accordingly
         if(ansCheck == target){
            gameScores[i] += answers.length - 1;
            System.out.println(names[i] + ", you did it!");
         }
         else if(ansCheck > target - 10 || ansCheck < target + 10){
            gameScores[i] += (answers.length - 1)/2;
            System.out.println("Good try, " + names[i] + ". You get partial points.");
         }
            
      }//closes for answers array loop
      
      return gameScores;
      
   }//end Numbers method
   
   /*
   public static void Timer(String game, int level){
      int playtime = 0;
      int[] letlev = {60, 45, 30};
      int[] numblev = {70, 60, 50, 40, 30};
      Timer timer = new Timer();
      Instant start = 0;
      Instant end = 0;
      
      if(game.equals("letters")){
         end = start.plus(Duration.ofSeconds(letlev[(level - 1) % 3]));
      }
      else if(game.equals("numbers")){
         end = start.plus(Duration.ofSeconds(numblev[(level - 1) % 3]));
      }
      
      for(int i = 0; i < end; i++){
         System.out.println(i);
      }
   }
   */   
      
   
}//end class TestWhatever
